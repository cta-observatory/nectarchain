import pandas as pd

# ==========================
#      READ DATA
# ==========================
file_path = (
    "/Users/hashkar/Desktop/nectarchain/src/nectarchain/"
    "user_scripts/hashkar/output/pix_time_uncer_data.txt"
)

df = pd.read_csv(file_path, header=0, sep="\t")

# ==========================
#      DEFINE TEMPERATURES
# ==========================
# Temperatures in decreasing order
temp_order = [25, 20, 14, 10, 5, 0, -5]

# Map of Run number to Temperature
temperature_map = {
    # 8V
    7020: 25,
    7077: 20,
    6954: 14,
    7144: 10,
    6543: 5,
    6672: 0,
    6729: -5,
    7029: 25,
    7086: 20,
    6963: 14,
    7153: 10,
    6552: 5,
    6681: 0,
    6738: -5,
    7038: 25,
    7095: 20,
    6972: 14,
    7162: 10,
    6561: 5,
    6690: 0,
    6747: -5,
    7047: 25,
    7104: 20,
    6981: 14,
    7171: 10,
    6570: 5,
    6699: 0,
    6756: -5,
    7056: 25,
    7113: 20,
    6990: 14,
    7180: 10,
    6579: 5,
    6708: 0,
    6765: -5,
    # 9V
    7021: 25,
    7078: 20,
    6955: 14,
    7145: 10,
    6544: 5,
    6673: 0,
    6730: -5,
    7030: 25,
    7087: 20,
    6964: 14,
    7154: 10,
    6553: 5,
    6682: 0,
    6739: -5,
    7039: 25,
    7096: 20,
    6973: 14,
    7163: 10,
    6562: 5,
    6691: 0,
    6748: -5,
    7048: 25,
    7105: 20,
    6982: 14,
    7172: 10,
    6571: 5,
    6700: 0,
    6757: -5,
    7057: 25,
    7114: 20,
    6991: 14,
    7181: 10,
    6580: 5,
    6709: 0,
    6766: -5,
    # 10V
    7022: 25,
    7079: 20,
    6956: 14,
    7146: 10,
    6545: 5,
    6674: 0,
    6731: -5,
    7031: 25,
    7088: 20,
    6965: 14,
    7155: 10,
    6554: 5,
    6683: 0,
    6740: -5,
    7040: 25,
    7097: 20,
    6974: 14,
    7164: 10,
    6563: 5,
    6692: 0,
    6749: -5,
    7049: 25,
    7106: 20,
    6983: 14,
    7173: 10,
    6572: 5,
    6701: 0,
    6758: -5,
    7058: 25,
    7115: 20,
    6992: 14,
    7183: 10,
    6581: 5,
    6710: 0,
    6767: -5,
    # 11V
    7023: 25,
    7080: 20,
    6957: 14,
    7147: 10,
    6546: 5,
    6675: 0,
    6732: -5,
    7032: 25,
    7089: 20,
    6966: 14,
    7156: 10,
    6555: 5,
    6684: 0,
    6741: -5,
    7041: 25,
    7098: 20,
    6975: 14,
    7165: 10,
    6564: 5,
    6693: 0,
    6750: -5,
    7050: 25,
    7107: 20,
    6984: 14,
    7174: 10,
    6573: 5,
    6702: 0,
    6759: -5,
    7059: 25,
    7116: 20,
    6993: 14,
    7184: 10,
    6582: 5,
    6711: 0,
    6768: -5,
    # 12V
    7024: 25,
    7081: 20,
    6958: 14,
    7148: 10,
    6547: 5,
    6676: 0,
    6733: -5,
    7033: 25,
    7090: 20,
    6967: 14,
    7157: 10,
    6556: 5,
    6685: 0,
    6742: -5,
    7042: 25,
    7099: 20,
    6976: 14,
    7166: 10,
    6565: 5,
    6694: 0,
    6751: -5,
    7051: 25,
    7108: 20,
    6985: 14,
    7175: 10,
    6574: 5,
    6703: 0,
    6760: -5,
    7060: 25,
    7117: 20,
    6994: 14,
    7185: 10,
    6583: 5,
    6712: 0,
    6769: -5,
    # 13V
    7025: 25,
    7082: 20,
    6959: 14,
    7149: 10,
    6548: 5,
    6677: 0,
    6734: -5,
    7034: 25,
    7091: 20,
    6968: 14,
    7158: 10,
    6557: 5,
    6686: 0,
    6743: -5,
    7043: 25,
    7100: 20,
    6977: 14,
    7167: 10,
    6566: 5,
    6695: 0,
    6752: -5,
    7052: 25,
    7109: 20,
    6986: 14,
    7176: 10,
    6575: 5,
    6704: 0,
    6761: -5,
    7061: 25,
    7118: 20,
    6995: 14,
    7186: 10,
    6584: 5,
    6713: 0,
    6770: -5,
    # 14V
    7026: 25,
    7083: 20,
    6960: 14,
    7150: 10,
    6549: 5,
    6678: 0,
    6735: -5,
    7035: 25,
    7092: 20,
    6969: 14,
    7159: 10,
    6558: 5,
    6687: 0,
    6744: -5,
    7044: 25,
    7101: 20,
    6978: 14,
    7168: 10,
    6567: 5,
    6696: 0,
    6753: -5,
    7053: 25,
    7110: 20,
    6987: 14,
    7177: 10,
    6576: 5,
    6705: 0,
    6762: -5,
    7062: 25,
    7119: 20,
    6996: 14,
    7187: 10,
    6585: 5,
    6714: 0,
    6771: -5,
    # 15V
    7027: 25,
    7084: 20,
    6961: 14,
    7151: 10,
    6550: 5,
    6679: 0,
    6736: -5,
    7036: 25,
    7093: 20,
    6970: 14,
    7160: 10,
    6559: 5,
    6688: 0,
    6745: -5,
    7045: 25,
    7102: 20,
    6979: 14,
    7169: 10,
    6568: 5,
    6697: 0,
    6754: -5,
    7054: 25,
    7111: 20,
    6988: 14,
    7178: 10,
    6577: 5,
    6706: 0,
    6763: -5,
    7063: 25,
    7120: 20,
    6997: 14,
    7188: 10,
    6586: 5,
    6715: 0,
    6772: -5,
    # 16V
    7028: 25,
    7085: 20,
    6962: 14,
    7152: 10,
    6551: 5,
    6680: 0,
    6737: -5,
    7037: 25,
    7094: 20,
    6971: 14,
    7161: 10,
    6560: 5,
    6689: 0,
    6746: -5,
    7046: 25,
    7103: 20,
    6980: 14,
    7170: 10,
    6569: 5,
    6698: 0,
    6755: -5,
    7055: 25,
    7112: 20,
    6989: 14,
    7179: 10,
    6578: 5,
    6707: 0,
    6764: -5,
    7064: 25,
    7121: 20,
    6998: 14,
    7189: 10,
    6587: 5,
    6716: 0,
    6773: -5,
}
voltage_map = {
    # 8 V
    7020: 8,
    7077: 8,
    6954: 8,
    7144: 8,
    6543: 8,
    6672: 8,
    6729: 8,
    6807: 8,
    7029: 8,
    7086: 8,
    6963: 8,
    7153: 8,
    6552: 8,
    6681: 8,
    6738: 8,
    6816: 8,
    7038: 8,
    7095: 8,
    6972: 8,
    7162: 8,
    6561: 8,
    6690: 8,
    6756: 8,
    6825: 8,
    7047: 8,
    7104: 8,
    6981: 8,
    7171: 8,
    6570: 8,
    6699: 8,
    6756: 8,
    6834: 8,
    7056: 8,
    7113: 8,
    6990: 8,
    7180: 8,
    6579: 8,
    6708: 8,
    6765: 8,
    6843: 8,
    # 9 V
    7021: 9,
    7078: 9,
    6955: 9,
    7145: 9,
    6544: 9,
    6673: 9,
    6730: 9,
    6808: 9,
    7030: 9,
    7087: 9,
    6964: 9,
    7154: 9,
    6553: 9,
    6682: 9,
    6739: 9,
    6817: 9,
    7039: 9,
    7096: 9,
    6973: 9,
    7163: 9,
    6562: 9,
    6691: 9,
    6748: 9,
    6826: 9,
    7048: 9,
    7105: 9,
    6982: 9,
    7172: 9,
    6571: 9,
    6700: 9,
    6757: 9,
    6835: 9,
    7057: 9,
    7114: 9,
    6991: 9,
    7181: 9,
    6580: 9,
    6709: 9,
    6766: 9,
    6844: 9,
    # 10 V
    7022: 10,
    7079: 10,
    6956: 10,
    7146: 10,
    6545: 10,
    6674: 10,
    6731: 10,
    6809: 10,
    7031: 10,
    7088: 10,
    6965: 10,
    7155: 10,
    6554: 10,
    6683: 10,
    6740: 10,
    6818: 10,
    7040: 10,
    7097: 10,
    6974: 10,
    7164: 10,
    6563: 10,
    6692: 10,
    6749: 10,
    6827: 10,
    7049: 10,
    7106: 10,
    6983: 10,
    7173: 10,
    6572: 10,
    6701: 10,
    6758: 10,
    6836: 10,
    7058: 10,
    7115: 10,
    6992: 10,
    7183: 10,
    6581: 10,
    6710: 10,
    6767: 10,
    6845: 10,
    # 11 V
    7023: 11,
    7080: 11,
    6957: 11,
    7147: 11,
    6546: 11,
    6675: 11,
    6732: 11,
    6810: 11,
    7032: 11,
    7089: 11,
    6966: 11,
    7156: 11,
    6555: 11,
    6684: 11,
    6741: 11,
    6819: 11,
    7041: 11,
    7098: 11,
    6975: 11,
    7165: 11,
    6564: 11,
    6693: 11,
    6750: 11,
    6828: 11,
    7050: 11,
    7107: 11,
    6984: 11,
    7174: 11,
    6573: 11,
    6702: 11,
    6759: 11,
    6837: 11,
    7059: 11,
    7116: 11,
    6993: 11,
    7184: 11,
    6582: 11,
    6711: 11,
    6768: 11,
    6846: 11,
    # 12 V
    7024: 12,
    7081: 12,
    6958: 12,
    7148: 12,
    6547: 12,
    6676: 12,
    6733: 12,
    6811: 12,
    7033: 12,
    7090: 12,
    6967: 12,
    7157: 12,
    6556: 12,
    6685: 12,
    6742: 12,
    6820: 12,
    7042: 12,
    7099: 12,
    6976: 12,
    7166: 12,
    6565: 12,
    6694: 12,
    6751: 12,
    6829: 12,
    7051: 12,
    7108: 12,
    6985: 12,
    7175: 12,
    6574: 12,
    6703: 12,
    6760: 12,
    6838: 12,
    7060: 12,
    7117: 12,
    6994: 12,
    7185: 12,
    6583: 12,
    6712: 12,
    6769: 12,
    6847: 12,
    # 13 V
    7025: 13,
    7082: 13,
    6959: 13,
    7149: 13,
    6548: 13,
    6677: 13,
    6734: 13,
    6812: 13,
    7034: 13,
    7091: 13,
    6968: 13,
    7158: 13,
    6557: 13,
    6686: 13,
    6743: 13,
    6821: 13,
    7043: 13,
    7100: 13,
    6977: 13,
    7167: 13,
    6566: 13,
    6695: 13,
    6752: 13,
    6830: 13,
    7052: 13,
    7109: 13,
    6986: 13,
    7176: 13,
    6575: 13,
    6704: 13,
    6761: 13,
    6839: 13,
    7061: 13,
    7118: 13,
    6995: 13,
    7186: 13,
    6584: 13,
    6713: 13,
    6770: 13,
    6848: 13,
    # 14 V
    7026: 14,
    7083: 14,
    6960: 14,
    7150: 14,
    6549: 14,
    6678: 14,
    6735: 14,
    6813: 14,
    7035: 14,
    7092: 14,
    6969: 14,
    7159: 14,
    6558: 14,
    6687: 14,
    6744: 14,
    6822: 14,
    7044: 14,
    7101: 14,
    6978: 14,
    7168: 14,
    6567: 14,
    6696: 14,
    6753: 14,
    6831: 14,
    7053: 14,
    7110: 14,
    6987: 14,
    7177: 14,
    6576: 14,
    6705: 14,
    6762: 14,
    6840: 14,
    7062: 14,
    7119: 14,
    6996: 14,
    7187: 14,
    6585: 14,
    6714: 14,
    6771: 14,
    6849: 14,
    # 15 V
    7027: 15,
    7084: 15,
    6961: 15,
    7151: 15,
    6550: 15,
    6679: 15,
    6736: 15,
    6814: 15,
    7036: 15,
    7093: 15,
    6970: 15,
    7160: 15,
    6559: 15,
    6688: 15,
    6745: 15,
    6823: 15,
    7045: 15,
    7102: 15,
    6979: 15,
    7169: 15,
    6568: 15,
    6697: 15,
    6754: 15,
    6832: 15,
    7054: 15,
    7111: 15,
    6988: 15,
    7178: 15,
    6577: 15,
    6706: 15,
    6763: 15,
    6841: 15,
    7063: 15,
    7120: 15,
    6997: 15,
    7188: 15,
    6586: 15,
    6715: 15,
    6772: 15,
    6850: 15,
    # 16 V
    7028: 16,
    7085: 16,
    6962: 16,
    7152: 16,
    6551: 16,
    6680: 16,
    6737: 16,
    6815: 16,
    7037: 16,
    7094: 16,
    6971: 16,
    7161: 16,
    6560: 16,
    6689: 16,
    6746: 16,
    6824: 16,
    7046: 16,
    7103: 16,
    6980: 16,
    7170: 16,
    6569: 16,
    6698: 16,
    6755: 16,
    6833: 16,
    7055: 16,
    7112: 16,
    6989: 16,
    7179: 16,
    6578: 16,
    6707: 16,
    6764: 16,
    6842: 16,
    7064: 16,
    7121: 16,
    6998: 16,
    7189: 16,
    6587: 16,
    6716: 16,
    6773: 16,
    6851: 16,
}


nsb_map = {
    # NSB 0 mA
    7020: 0,
    7077: 0,
    6954: 0,
    7144: 0,
    6543: 0,
    6672: 0,
    6729: 0,
    6807: 0,
    7021: 0,
    7078: 0,
    6955: 0,
    7145: 0,
    6544: 0,
    6673: 0,
    6730: 0,
    6808: 0,
    7022: 0,
    7079: 0,
    6956: 0,
    7146: 0,
    6545: 0,
    6674: 0,
    6731: 0,
    6809: 0,
    7023: 0,
    7080: 0,
    6957: 0,
    7147: 0,
    6546: 0,
    6675: 0,
    6732: 0,
    6810: 0,
    7024: 0,
    7081: 0,
    6958: 0,
    7148: 0,
    6547: 0,
    6676: 0,
    6733: 0,
    6811: 0,
    7025: 0,
    7082: 0,
    6959: 0,
    7149: 0,
    6548: 0,
    6677: 0,
    6734: 0,
    6812: 0,
    7026: 0,
    7083: 0,
    6960: 0,
    7150: 0,
    6549: 0,
    6678: 0,
    6735: 0,
    6813: 0,
    7027: 0,
    7084: 0,
    6961: 0,
    7151: 0,
    6550: 0,
    6679: 0,
    6736: 0,
    6814: 0,
    7028: 0,
    7085: 0,
    6962: 0,
    7152: 0,
    6551: 0,
    6680: 0,
    6737: 0,
    6815: 0,
    # NSB 10.6 mA
    7029: 10.6,
    7086: 10.6,
    6963: 10.6,
    7153: 10.6,
    6552: 10.6,
    6681: 10.6,
    6738: 10.6,
    6816: 10.6,
    7030: 10.6,
    7087: 10.6,
    6964: 10.6,
    7154: 10.6,
    6553: 10.6,
    6682: 10.6,
    6739: 10.6,
    6817: 10.6,
    7031: 10.6,
    7088: 10.6,
    6965: 10.6,
    7155: 10.6,
    6554: 10.6,
    6683: 10.6,
    6740: 10.6,
    6818: 10.6,
    7033: 10.6,
    7090: 10.6,
    6967: 10.6,
    7157: 10.6,
    6556: 10.6,
    6685: 10.6,
    6742: 10.6,
    6820: 10.6,
    7034: 10.6,
    7091: 10.6,
    6968: 10.6,
    7158: 10.6,
    6557: 10.6,
    6686: 10.6,
    6743: 10.6,
    6821: 10.6,
    7035: 10.6,
    7092: 10.6,
    6969: 10.6,
    7159: 10.6,
    6558: 10.6,
    6687: 10.6,
    6744: 10.6,
    6822: 10.6,
    7036: 10.6,
    7093: 10.6,
    6970: 10.6,
    7160: 10.6,
    6559: 10.6,
    6688: 10.6,
    6745: 10.6,
    6823: 10.6,
    7037: 10.6,
    7094: 10.6,
    6971: 10.6,
    7161: 10.6,
    6560: 10.6,
    6689: 10.6,
    6746: 10.6,
    6824: 10.6,
    # NSB 20.4 mA
    7038: 20.4,
    7095: 20.4,
    6972: 20.4,
    7162: 20.4,
    6561: 20.4,
    6690: 20.4,
    6747: 20.4,
    6825: 20.4,
    7039: 20.4,
    7096: 20.4,
    6973: 20.4,
    7163: 20.4,
    6562: 20.4,
    6691: 20.4,
    6748: 20.4,
    6826: 20.4,
    7040: 20.4,
    7097: 20.4,
    6974: 20.4,
    7164: 20.4,
    6563: 20.4,
    6692: 20.4,
    6749: 20.4,
    6827: 20.4,
    7042: 20.4,
    7099: 20.4,
    6976: 20.4,
    7166: 20.4,
    6565: 20.4,
    6694: 20.4,
    6751: 20.4,
    6829: 20.4,
    7043: 20.4,
    7100: 20.4,
    6977: 20.4,
    7167: 20.4,
    6566: 20.4,
    6695: 20.4,
    6752: 20.4,
    6830: 20.4,
    7044: 20.4,
    7101: 20.4,
    6978: 20.4,
    7168: 20.4,
    6567: 20.4,
    6696: 20.4,
    6753: 20.4,
    6831: 20.4,
    7045: 20.4,
    7102: 20.4,
    6979: 20.4,
    7169: 20.4,
    6568: 20.4,
    6697: 20.4,
    6754: 20.4,
    6832: 20.4,
    7046: 20.4,
    7103: 20.4,
    6980: 20.4,
    7170: 20.4,
    6569: 20.4,
    6698: 20.4,
    6755: 20.4,
    6833: 20.4,
    # NSB 39.8 mA
    7047: 39.8,
    7104: 39.8,
    6981: 39.8,
    7171: 39.8,
    6570: 39.8,
    6699: 39.8,
    6756: 39.8,
    6834: 39.8,
    7048: 39.8,
    7105: 39.8,
    6982: 39.8,
    7172: 39.8,
    6571: 39.8,
    6700: 39.8,
    6757: 39.8,
    6835: 39.8,
    7049: 39.8,
    7106: 39.8,
    6983: 39.8,
    7173: 39.8,
    6572: 39.8,
    6701: 39.8,
    6758: 39.8,
    6836: 39.8,
    7051: 39.8,
    7108: 39.8,
    6985: 39.8,
    7175: 39.8,
    6574: 39.8,
    6703: 39.8,
    6760: 39.8,
    6838: 39.8,
    7052: 39.8,
    7109: 39.8,
    6986: 39.8,
    7176: 39.8,
    6575: 39.8,
    6704: 39.8,
    6761: 39.8,
    6839: 39.8,
    7053: 39.8,
    7110: 39.8,
    6987: 39.8,
    7177: 39.8,
    6576: 39.8,
    6705: 39.8,
    6762: 39.8,
    6840: 39.8,
    7054: 39.8,
    7111: 39.8,
    6988: 39.8,
    7178: 39.8,
    6577: 39.8,
    6706: 39.8,
    6763: 39.8,
    6841: 39.8,
    7055: 39.8,
    7112: 39.8,
    6989: 39.8,
    7179: 39.8,
    6578: 39.8,
    6707: 39.8,
    6764: 39.8,
    6842: 39.8,
    # NSB 78.8 mA
    7056: 78.8,
    7113: 78.8,
    6990: 78.8,
    7180: 78.8,
    6579: 78.8,
    6708: 78.8,
    6765: 78.8,
    6843: 78.8,
    7057: 78.8,
    7114: 78.8,
    6991: 78.8,
    7181: 78.8,
    6580: 78.8,
    6709: 78.8,
    6766: 78.8,
    6844: 78.8,
    7058: 78.8,
    7115: 78.8,
    6992: 78.8,
    7183: 78.8,
    6581: 78.8,
    6710: 78.8,
    6767: 78.8,
    6845: 78.8,
    7060: 78.8,
    7117: 78.8,
    6994: 78.8,
    7185: 78.8,
    6583: 78.8,
    6712: 78.8,
    6769: 78.8,
    6847: 78.8,
    7061: 78.8,
    7118: 78.8,
    6995: 78.8,
    7186: 78.8,
    6584: 78.8,
    6713: 78.8,
    6770: 78.8,
    6848: 78.8,
    7062: 78.8,
    7119: 78.8,
    6996: 78.8,
    7187: 78.8,
    6585: 78.8,
    6714: 78.8,
    6771: 78.8,
    6849: 78.8,
    7063: 78.8,
    7120: 78.8,
    6997: 78.8,
    7188: 78.8,
    6586: 78.8,
    6715: 78.8,
    6772: 78.8,
    6850: 78.8,
    7064: 78.8,
    7121: 78.8,
    6998: 78.8,
    7189: 78.8,
    6587: 78.8,
    6716: 78.8,
    6773: 78.8,
    6851: 78.8,
}


# Map Run to Temperature
df["Temperature"] = df["Run"].map(temperature_map)
df["Voltage"] = df["Run"].map(voltage_map)
df["NSB"] = df["Run"].map(nsb_map)

# Drop rows without temperature info
df = df.dropna(subset=["Temperature"])

# Convert to categorical with proper order
df["Temperature"] = pd.Categorical(
    df["Temperature"], categories=temp_order, ordered=True
)
df["Voltage"] = df["Voltage"].astype(str)
df["NSB"] = df["NSB"].astype(str)
